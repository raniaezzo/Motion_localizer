function f = timpResp(tau, na, nb, tstep, n)%% TIMPRESP - make a mono- or biphasic temporal impulse response%% usage: %   TIMPRESP(TAU, NA, [NB], [TSTEP], [N])% 	TAU is time constant (e.g. 6 msec)% 	ordera is positive component order (e.g. 2)% 	orderb [optional] is negative component order (e.g. 10)%	for monophasic, enter two args. or set nb=0.% 	tstep [optional] specifies msec/element%	n [optional] specifies length of returned vector% 2.24.01 LKC (sbs) if nargin < 2,	error('timpResp: must specify tau and na.  try 6 and 2')elseif nargin < 4,	tstep = 1;	n = 128;elseif nargin < 5,	n = 128;elseif nargin > 5,	error('timpResp: too many args')endtmax = (n-1).*tstep;t=0:tstep:tmax;afact = prod(1:na-1);a = (t./tau).^(na-1) .* exp(-t./tau) ./ (tau*afact);f = a;if ((nargin > 2) & (nb ~= 0)),			%*** if bi-phasic ***	bfact = prod(1:nb-1);	b = (t./tau).^(nb-1) .* exp(-t./tau) ./ (tau*bfact);	f = f - b;end