function s=spike3d(alpha, r, c, p)% SPIKE3D - makes a volume in which the value is proportional to the%           distance from the origin (to the alpha power).% history:% 3/30/2002     lkc     wrote it based on spike% 4/??/2002     lkc     fussed around a bunch to try and get transforms of%                       the output to agree with the requested slope%                       (alpha).  The upshot of this was the mystery%                       constant k, whose existance I gleaned from reading%                       a book on higher-dimensional fractals, but whose%                       value I simply determined emprically.  If anyone%                       reading this understands the deal with this%                       constant, please educate me!% 7/4/2002      lkc     formatted comments k = 0.4;if nargin == 2,     c=r;     p=r; ends = ones(r, c, p); y = linspace(-r./2, r./2, r);x = linspace(-c./2, c./2, c);z = linspace(-p./2, p./2, p);% dy = (y(2)-y(1))./2.6;% dx = (x(2)-x(1))./2.6;% dz = (z(2)-z(1))./2.6;% y(1:r./2) = y(1:r./2)+dy;% y((r./2)+1:end) = y((r./2)+1:end)-dy;% x(1:c./2) = x(1:c./2)+dx;% x((c./2)+1:end) = x((c./2)+1:end)-dx;% z(1:p./2) = z(1:p./2)+dz;% z((p./2)+1:end) = z((p./2)+1:end)-dz;[X, Y, Z] = meshgrid(x, y, z);dists = sqrt(X.^2 + Y.^2 + Z.^2);maxdist = max([r/2 c/2 p/2]);s = s./(dists.^(alpha+k));%s(find(dists>maxdist))=0;%keyboard